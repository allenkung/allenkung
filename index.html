<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>Allen&#39;s Life</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="allen kung">
  
  
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Allen's Life">
<meta property="og:url" content="http://blog.allenkung.com/index.html">
<meta property="og:site_name" content="Allen's Life">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Allen's Life">
<meta name="twitter:description">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Allen&#39;s Life</a></h1>
    <p>Was künstlich ist verlanst geschlossenen Raum.</p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content">




  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2016/03/deduction-between-two-dates/">
  <time datetime="2016-03-16T06:50:01.000Z">
    2016-03-16
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2016/03/deduction-between-two-dates/">JS 日期求差</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>想实现一个需求：显示某个活动网页离开始日期还有几天，或者如果已经开始了，离结束日期还有几天。相关的时间变量有三个：</p>
<ul>
<li>开始时间: startDate</li>
<li>结束时间: endDate</li>
<li>当前时间: currentDate</li>
</ul>
<p>本来打算用 <a href="http://momentjs.com/">moment.js</a> 来实现，但是折腾了半天竟然没有找到简单求差的函数…… 然后请教了一下 eleme 的前端同事乔治，不消片刻就甩给我这段代码：</p>
<pre><code>Math.ceil((new Date(&apos;2016-03-10&apos;).getTime() - 8*3600*1000 - Date.now()) / 86400000)
</code></pre><p>突然意识到自己好弱啊  ʅ(‾◡◝) 然后打起精神去做了下 Research：</p>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2016/03/deduction-between-two-dates/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2016/02/ruts-under-snow/">
  <time datetime="2016-02-20T09:56:54.000Z">
    2016-02-20
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2016/02/ruts-under-snow/">雪痕</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p><img src="/static/images/ruts-under-snow-01.jpg" alt="Niseko Hirafu, photo by Du Xin"></p>
<p>大山里人们滑过的长长雪痕，不消片刻就被落雪覆盖了。雪地又恢复了它原本的平整，如同时间可以消磨一切，对于雪山来说更快，只需要片刻。</p>
<p>这就是雪山的性格，雪的伤痕用雪覆盖。人也是一样吧，爱的伤痕应该用爱来覆盖。</p>
<p>滑过雪的人有这样的经验，没有压过的粉雪异常松软，像棉花糖，调皮地滑过去把它们打散开来像云、像雾。有些可爱、羞涩的成分就像初恋一般。</p>
<p>而被压过的雪，或者说雪痕的道路，则有自己的坚持和性格。往往很容易被雪痕导向某个特定的方向。某种意义上是被塑造过的，包含某种预期或者某种可能性占了大部分。必须得顺着雪痕的方向，讨好她、抚慰她。</p>
<p>大山不喜欢伤痕，我觉得它是不喜欢自己可预测的样子。山神要保持他的神秘，同时也要包含更多的可能性，也就是大山原初的样子。毕竟大山的生命跟人类比起来简直就是永恒，每一道雪痕对大山来说都是削减了他的可能性，剥夺了它对未来的保留、它的珍藏、它的神秘。</p>
<p>所以山神用大雪把雪痕遮上，抚摸它们，把它们珍藏。雪痕并没有消逝，而是成为密度更高的存在。在最接近大山表面作为新雪的根基，形成某种回路。这些人类留下的痕迹，也许，帮助大山藉由这些回路以人类的方式思考的吧？雪痕是大山和人类沟通的方式，也是滑雪者们对大山略显自私的爱。</p>
<p>但是大山毕竟是大山，总可以遮上雪痕，以一种原初的方式接纳新的滑雪者们。毕竟，人类还没有存在的时候它就已经屹立在这里，即便将来人类消失了它也还是在这里。</p>
<p>如此想来，从人类的角度看大山是孤独的。</p>
<p>不过孤独这样的字眼，大山是不会理解的。</p>
<p>等到春暖花开、白雪消融的时候，那些人类留在大山表面的雪痕回路，连同大山为了覆盖雪痕而盖上的绒软的雪。都会化成清澈的水，连同大山对人类的回忆一起，滋养山中的植被。</p>
<p>毕竟人类生命之短暂，远不如一棵悬崖边的青松长情。</p>
<p>也正因为生命的短暂，我们无法像大山一样保持一种对未来的开放性。对于爱大山的人，永远不会停歇，他们有种紧迫性，想要用短短的百年来亲眼去看看他们所爱的山用百万、千万、甚至亿万年所经历的风景。在这个过程中他们找到生命的意义，邂逅旅途的伴侣，建功立业，诗意地存在。</p>
<p>– Paradise Hutte, Niseko Annupuri, Hokkaido, Japan 2016.2.7</p>
<hr>
<p>农历新年前去了次北海道，分别去了四个不同的雪场，白天滑雪晚上泡温泉。被北海道人们的淳朴和敬业深深打动，在 Niseko Annupuri 雪场的最后一天，在半山腰的 Paradise Hutte 里一口气写了上面这篇短文。今年打算把这篇短文和这次北海道之旅取材的所思所想写成小说，希望能给出让自己满意的答案。</p>
<p>Gitbook 地址： <a href="https://allenkung.gitbooks.io/ruts-under-snow/content/" target="_blank" rel="external">https://allenkung.gitbooks.io/ruts-under-snow/content/</a></p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2016/01/recommended-wordpress-plugins/">
  <time datetime="2016-01-06T06:31:01.000Z">
    2016-01-06
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2016/01/recommended-wordpress-plugins/">推荐几款实用的 Wordpress Plugin</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>之前看到给朋友做网站的英国老爷爷装了一堆 Wordpress Plugin，正好手边有个项目把 Wordpress 当 REST API 来用，就小小研究下了装了下面这几个 Plugin：</p>
<ol>
<li><a href="https://wordpress.org/plugins/json-api/">JSON API</a></li>
<li><a href="http://magicfields.org/">Magic Fields 2</a></li>
<li><a href="https://wordpress.org/plugins/wp-super-cache/">WP Super Cache</a></li>
<li><a href="http://blog.milandinic.com/wordpress/plugins/disable-google-fonts/">Disable Google Fonts</a></li>
<li><a href="http://lomu.me/post/wp-acceleration-for-china">WP Acceleration for China</a></li>
<li><a href="http://icwp.io/home">WordPress Security Firewall</a></li>
<li><a href="http://lesterchan.net/portfolio/programming/php/">WP-DBManager</a></li>
<li><a href="http://wordpress.org/extend/plugins/disable-comments/">Disable Comments</a></li>
<li><a href="http://wordpress.org/plugins/disable-wordpress-updates/">Disable All WordPress Updates</a></li>
<li><a href="http://www.jolanders.com/wordpress_plugins.php?plugin=custom-dashboard-help">Custom Dashboard Help</a></li>
<li><a href="http://wpdoc.de/plugins/">Admin Dashboard Last Edits</a></li>
<li><a href="http://w-shadow.com/blog/2008/12/20/admin-menu-editor-for-wordpress/">Admin Menu Editor</a></li>
</ol>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2016/01/recommended-wordpress-plugins/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/11/things-needtodo-when-got-aliyunecs/">
  <time datetime="2015-11-24T07:11:01.000Z">
    2015-11-24
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/11/things-needtodo-when-got-aliyunecs/">入手 Aliyun ECS 后首先应该做的事情</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>持续更新中……</p>
<h2 id="更改-root-user-密码"><a href="#更改-root-user-密码" class="headerlink" title="更改 root user 密码"></a>更改 root user 密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ passwd&#10;Enter new UNIX password: &#10;Retype new UNIX password: &#10;passwd: password updated successfully</span><br></pre></td></tr></table></figure>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2015/11/things-needtodo-when-got-aliyunecs/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/11/git-tips-in-small-project/">
  <time datetime="2015-11-20T05:43:11.000Z">
    2015-11-20
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/11/git-tips-in-small-project/">Small Project 中的 Git 使用心得</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>因为 <a href="http://gamebau.com" target="_blank" rel="external">公司官网</a> 策划、设计（Sketch）、前端（Bootstrap）、后端（Express）都是我一个人搞定，所以考虑边学变尝试的角度，从一开始就用了 Git 作为 Version Control System。</p>
<p>比较了 <a href="http://github.com" target="_blank" rel="external">GitHub</a> 和 <a href="http://bitbucket.org" target="_blank" rel="external">Bitbucket</a>，虽然前者的 community 比较强大，但是后者给小 studio 提供了非常吸引人的 plan：</p>
<ul>
<li><a href="https://github.com/pricing" target="_blank" rel="external">Github</a>：鼓励开源，按照 Private Repository 的数量收费；</li>
<li><a href="https://bitbucket.org/product/pricing?tab=cloud-pricing" target="_blank" rel="external">Bitbucket</a>：按照 team 的人员数量收费，5 users 以内的 Private Repository 免费。</li>
</ul>
<p>这个 project 就我一个人，所以自然就选了 Bitbucket。一开始什么都在 master branch 上操作，主要是用来把白天公司 mbp 上没完成的代码 pass 到家里的 mbp 上继续写。然后觉得同时写各种功能变得越来越乱，就根据各种供能建了好多 branch，但是合来合去也觉得麻烦就怕会出错。</p>
<p>稍微研究了下网上的 Git 部署策略文章，找到阮一峰老师的这篇《<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">Git分支管理策略</a>》，终于找到适合自己的策略了。</p>
<p><img src="http://7jpo5r.com1.z0.glb.clouddn.com/blog/git-workflow.png-width620" alt="Git Workflow"></p>
<!--readmore-->
<p>大致是上图这样的 workflow，主要分成 3 个 branch:</p>
<ol>
<li>主线分支 Master</li>
<li>开发分支 Develop</li>
<li>临时性分支 temporary branches:<ul>
<li>功能分支 Feature</li>
<li>预发布分支 Release</li>
<li>抓虫分支 Fixbug</li>
</ul>
</li>
</ol>
<p>具体各个 branch 的描述大家去看阮一峰老师的<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">文章</a>，这里仅仅提一下几个重点。</p>
<h4 id="代码库应该有一个、且仅有一个主分支-Master"><a href="#代码库应该有一个、且仅有一个主分支-Master" class="headerlink" title="代码库应该有一个、且仅有一个主分支 Master"></a>代码库应该有一个、且仅有一个主分支 Master</h4><p>首先，代码库应该有一个、且仅有一个主分支。所有提供给用户使用的正式版本，都在这个主分支上发布并用 Tag 标记。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git tag -a 1.2</span><br></pre></td></tr></table></figure>
<h4 id="为了保证版本演进的清晰，使用-–no-ff-参数"><a href="#为了保证版本演进的清晰，使用-–no-ff-参数" class="headerlink" title="为了保证版本演进的清晰，使用 –no-ff 参数"></a>为了保证版本演进的清晰，使用 –no-ff 参数</h4><p>默认情况下，Git 执行”快进式合并”（fast-farward merge），会直接将 Master 分支指向 Develop 分支。使用–no-ff参数后，会执行正常合并，在Master分支上生成一个新节点。为了保证版本演进的清晰，我们希望采用这种做法。关于合并的更多解释，请参考 Benjamin Sandofsky 的《<a href="http://sandofsky.com/blog/git-workflow.html" target="_blank" rel="external">Understanding the Git Workflow</a>》。</p>
<p>将Develop分支发布到Master分支的命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># &#20999;&#25442;&#21040;Master&#20998;&#25903;&#10;$ git checkout master&#10;&#10;# &#23545;Develop&#20998;&#25903;&#36827;&#34892;&#21512;&#24182;&#10;$ git merge --no-ff develop</span><br></pre></td></tr></table></figure>
<h4 id="记得删除临时性分支"><a href="#记得删除临时性分支" class="headerlink" title="记得删除临时性分支"></a>记得删除临时性分支</h4><p>Feature、Release、Fixbug 这三种分支都属于临时性需要，使用完以后，应该删除，使得代码库的常设分支始终只有 Master 和 Develop。</p>
<p>创建一个功能分支：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b feature-x develop</span><br></pre></td></tr></table></figure>
<p>开发完成后，将功能分支合并到 develop 分支：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout develop&#10;$ git merge --no-ff feature-x</span><br></pre></td></tr></table></figure>
<p>删除 feature 分支：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d feature-x</span><br></pre></td></tr></table></figure>
    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/11/webkit-not-respecting-overflow-hidden-with-border-radius/">
  <time datetime="2015-11-19T10:12:26.000Z">
    2015-11-19
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/11/webkit-not-respecting-overflow-hidden-with-border-radius/">Webkit not respecting overflow:hidden with border radius</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>最近在 project 中想要实现这样一个效果：光标移过 icon 的时候，background 图片 zoom in 响应这个 hover 事件。</p>
<p><img src="http://7jpo5r.com1.z0.glb.clouddn.com/blog/webkit-not-respecting-overflow-hidden-with-border-radius-01.gif" alt="With border-radius"></p>
<p>容器结构很简单，一个 <code>overflow:hidden</code> 的背景容器，和一张作为前景的  img：</p>
<pre><code>&lt;div class=&quot;box&quot;&gt;
    &lt;div class=&quot;bg-container&quot;&gt;
        &lt;img src=&quot;bg.jpg&quot; / &gt;
    &lt;/div&gt;
    &lt;img src=&quot;fg.png&quot; /&gt;
&lt;/div&gt;
</code></pre><p>然后问题来了，仔细观察上面的 gif 会发现，当 bg.jpg 在 webkit 下执行 <code>transform: scale()</code> 动画的时候，<code>overflow:hidden</code> 的 mask 容器 <code>border-radius</code> 会瞬间失效直到动画结束。（笔者偷懒并没有去测试 IE 和 FF）</p>
<p>我尝试了下用图片遮罩，就是盖一个白色的圆角 mask 在背景上面：</p>
<p><img src="http://7jpo5r.com1.z0.glb.clouddn.com/blog/webkit-not-respecting-overflow-hidden-with-border-radius-02.jpg" alt="With mask"></p>
<p>不过如果这个 mask 的 top 位置和背景一致的话，在动画执行的时候就会产生一条 border 线（可能还是浏览器渲染的关系），这个比较容易解决写个 padding 就好了：</p>
<p><img src="http://7jpo5r.com1.z0.glb.clouddn.com/blog/webkit-not-respecting-overflow-hidden-with-border-radius-03.jpg" alt=""></p>
<p>Stackoverflow 上这两篇提供不同的思路比较有帮助，不过最终笔者换了其他的<a href="http://gamebau.com/games" target="_blank" rel="external">实现方式</a>：</p>
<ul>
<li><a href="http://stackoverflow.com/questions/14383632/webkit-border-radius-and-overflow-bug-when-using-any-animation-transition" target="_blank" rel="external">add height:100%</a></li>
<li><a href="http://stackoverflow.com/questions/16878279/overflowhidden-ignored-with-border-radius-and-css-transforms-webkit-only" target="_blank" rel="external">add -webkit-mask-image</a></li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/10/ideas-about-GTD/">
  <time datetime="2015-10-18T18:33:26.000Z">
    2015-10-19
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/10/ideas-about-GTD/">关于 GTD 的一些想法</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h2 id="拖延之苦"><a href="#拖延之苦" class="headerlink" title="拖延之苦"></a>拖延之苦</h2><p>作为一个拖延癌晚期病患，饱受拖延症给人生带来的种种懊恼之苦，便经常时不时地总结下对症良药。一旦狠下心来坚持久了就会成功比如去年减肥 20 斤，不过后来健身房装修所以功亏一篑又开始胖了。</p>
<p>为啥明明对自己的人生计划得挺好，但总是事与愿违，看着周遭的人与事越变越好，唯独自己却陷入困境。说穿了，主要还是拖延（懒）吧！</p>
<h2 id="存在主义"><a href="#存在主义" class="headerlink" title="存在主义"></a>存在主义</h2><p>早些时候读虚无主义觉得仿佛就人生没有任何意义，宇宙中所以万物都逃离不了湮灭的结果。但是萨特的存在主义是一种人道主义，他让我明白了光靠「想」是无用的，理念需要借助「人」作为介质，通过「行动」才能对现实世界造成影响。</p>
<blockquote>
<p>Ideas → Actions → Effects</p>
</blockquote>
<p>所以只有行动才能造就意义，人只有通过行动来创造自身。</p>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2015/10/ideas-about-GTD/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/10/basic-gulp-plugin/">
  <time datetime="2015-10-13T08:04:40.000Z">
    2015-10-13
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/10/basic-gulp-plugin/">Gulp Plugin 入门</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>最近在学习 Gulp，刚开始看的时候一头雾水，看了几篇文章之后稍微有点理解是怎么运行的了，几乎都是依赖各种 <a href="http://gulpjs.com/plugins/">plugin</a>。其中一篇《<a href="http://segmentfault.com/a/1190000000494326">前端从零单排之 Gulp</a>》里提到了几个基本的 plugin，觉得很实用：</p>
<ol>
<li><a href="https://www.npmjs.com/package/gulp-less">Less compile (gulp-less)</a></li>
<li><a href="https://github.com/postcss/autoprefixer">Autoprefixer (gulp-autoprefixer)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-minify-css">Minify CSS (gulp-minify-css)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-jshint/">JSHint (gulp-jshint)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-concat/">Concatenation (gulp-concat)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-uglify/">Uglify (gulp-uglify)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-imagemin/">Compress images (gulp-imagemin)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-livereload">LiveReload (gulp-livereload)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-clean">Clean files for a clean build (gulp-clean)</a></li>
<li><a href="https://npmjs.org/package/gulp-cache/">Caching of images so only changed images are compressed (gulp-cache)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-notify/">Notify of changes (gulp-notify)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-ejs/">EJS Generator (gulp-ejs)</a></li>
<li><a href="https://www.npmjs.com/package/gulp-watch">gulp-watch</a></li>
<li><a href="https://www.npmjs.com/package/main-bower-files">main-bower-files</a></li>
</ol>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2015/10/basic-gulp-plugin/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/09/a-life-in-photos/">
  <time datetime="2015-09-13T07:52:01.000Z">
    2015-09-13
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/09/a-life-in-photos/">Tom Hunter: A Life In Photos</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p><img src="http://7jpo5r.com1.z0.glb.clouddn.com/blog/a-life-in-photos-01.jpg-width620" alt="Mingsheng Lecture, Tom Hunter: A Life In Photos"></p>
<p><a href="http://www.tomhunter.org">Tom Hunter</a> 是一位平民艺术家，他从周遭的社区和生活中吸取灵感，他的作品丰富多样，探讨不同于主流视角的生活方式，同时具备鲜明的个人风格。</p>
    
  </div>
  <footer class="end-sep">
    
      
        <div class="alignleft">
          <a href="/2015/09/a-life-in-photos/#more" class="more-link">阅读全文</a>
        </div>
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/08/ejs-html-escape-problem/">
  <time datetime="2015-08-31T03:26:01.000Z">
    2015-08-31
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/08/ejs-html-escape-problem/">ejs 中的 HTML tag 转义问题</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>最近在用 <a href="http://expressjs.com/" target="_blank" rel="external">Express</a> 开发公司网站，用了 <a href="https://github.com/jeresig/i18n-node-2" target="_blank" rel="external">i18n-node-2</a> 这个多语言组件，需要将网站的文字部分都用 JSON 文件储存。遇到一个小问题，如果是带有 HTML 标签的内容，比如：</p>
<pre><code>这里是&lt;a href=&quot;#&quot;&gt;链接&lt;/a&gt;的文字内容
</code></pre><p>上面这段存到 JSON 数组里的话要转义一下：</p>
<pre><code>&quot;这里是&lt;a href=\&quot;#\&quot;&gt;链接&lt;/a&gt;的文字内容&quot;
</code></pre><p>但是在 ejs 模板中输出的时候 HTML tag 总是 output 转义字符串（Escape Sequence）：</p>
<pre><code>这里是&amp;lt;a href=&amp;quot;#&amp;quot;&amp;gt;链接&amp;lt;/a&amp;gt;的文字内容
</code></pre><p>查阅了 ejs 的 github <a href="https://github.com/tj/ejs" target="_blank" rel="external">README</a> 文档中有如下介绍：</p>
<ul>
<li>Unbuffered code for conditionals etc <code>&lt;% code %&gt;</code></li>
<li>Escapes html by default with <code>&lt;%= code %&gt;</code></li>
<li>Unescaped buffering with <code>&lt;%- code %&gt;</code></li>
</ul>
<p>发现想要 output HTML字符实体（Character Entities）的话只要使用 <code>&lt;%- code %&gt;</code>输出就可以啦！原来这么简单，本来还想是不是设计一个转义函数，瞬间觉得自己萌萌哒 ^_^</p>
<hr>
<p>相关资料：</p>
<ul>
<li><a href="http://www.css88.com/tool/html-escape/" target="_blank" rel="external">前端开发工具箱：HTML 在线转义工具</a></li>
<li><a href="http://114.xixik.com/character/" target="_blank" rel="external">HTML 字符实体（Character Entities），转义字符串（Escape Sequence）</a></li>
<li><a href="http://www.w3chtml.com/html/character.html" target="_blank" rel="external">HTML 转义字符</a></li>
</ul>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  

  <nav id="pagination">
  
  
    <a href="/page/2/" class="next">下一页</a>
  
  <div class="clearfix"></div>
</nav>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2016 <a href="/">allen kung</a>
  
</div>
<div class="theme-copyright">
  Theme <a href="#">Notepaper</a>, based on <a href="#">Modernist</a>.
</div>
<div class="clearfix"></div></footer>
  <script src="//libs.baidu.com/jquery/1.8.0/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
  var disqus_shortname = 'allenkung';

  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>